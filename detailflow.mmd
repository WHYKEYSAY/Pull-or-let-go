flowchart TD
 subgraph Setup["Setup"]
     A["Start Game"] --> B["Choose classmate's Appearance"];
     B --> C["Name Your classmate"];
 end
 subgraph subGraph1["Year 1"]
     D["Year 1: The New Student"]
     E{"Event: Classmates organize a party.<br>Question: You notice the new student is alone. Will you invite them?"}
     F["Event: Midterm Exams.<br>Question: You see your classmate is stressed about exams. Will you help?"]
     I["Bullying Event 1: Rumors<br>Event: In the library, you overhear classmates spreading a rumor that your classmate was expelled for stealing."]
     I_Choice{"Question: How do you react to this situation?"}
     J["Event: End-of-term party.<br>Question: Your classmate wasn't invited. Will you ask them to go with you?"]
     M["Begin Year 2"]
 end
 subgraph subGraph2["Year 2"]
     N{"Event: Club Week.<br>Question: Your classmate invites you to join the woodworking club. Do you agree?"}
     O["Bullying Event 2: Shoving<br>Event: You see classmates shoving your classmate by the lockers, mocking them for imitating someone."]
     O_Choice{"Question: How do you respond?"}
     P["Event: Birthday Party.<br>Question: Your classmate is once again not invited to a popular kid's party. Do you invite them?"]
     S["Begin Year 3"]
 end
 subgraph subGraph3["Year 3"]
     T{"Event: New Classrooms.<br>Question: Both you and your classmate are lost in the new building. Do you find the classroom together?"}
     U["Bullying Event 3: Physical Attack<br>Event: In an alley, you see your classmate being cornered while bullies throw things at them."]
     U_Choice{"Question: How do you help them?"}
     V["Event: Volunteer Opportunity.<br>Question: You get a great volunteer opportunity and can bring one classmate. Do you invite your classmate?"]
     Y["Begin Year 4"]
 end
 subgraph subGraph4["Year 4 & Graduation"]
     Z{"Event: University Visit.<br>Question: On the bus to the university, your classmate is sitting alone. Do you go sit with them?"}
     AA["Event: Capstone Project.<br>Question: The final project for university admission can be done in teams. Do you ask your classmate to partner up?"]
     BB["Event: Graduation Ceremony.<br>Question: Bullies are waiting to see your classmate be humiliated. Do you go pick out outfits with them?"]
 end
 subgraph Endings["Endings"]
    CC["Calculate Final Ending<br>based on Friendship Level & Bullying Event Choices"]
    E1["Ending 1: Dreams Achieved<br>$friendship: >=40<br>$displaySeverity: 0"]
    E2["Ending 2: Paths Diverged<br>$friendship: >=40<br>$displaySeverity: 0.5 - 2.5"]
    E3["Ending 3: Fading into Silence<br>$friendship: >=40<br>$displaySeverity: 4.0 - 6.5"]
    E4["Ending 4: The Turn of the Tide<br>$friendship: >=40<br>$displaySeverity: 1.0 - 3.5"]
    E5["Ending 5: Crushed by Pressure<br>$friendship: >=40<br>$displaySeverity: 6.0 - 9.5"]
    E6["Ending 6: A Tragic Loss<br>Can occur in both branches<br>High Friendship Severity: >=6.5<br>Low Friendship Severity: >=6.0"]
    E7["Ending 7: Rescue and Retribution<br>$friendship: >=40<br>$displaySeverity: 8.5 - 9.5"]
 end
 subgraph s1["Post-Game"]
     F1["View Summary & Achievements"]
 end

 A --> B
 B --> C
 C --> D
 D --> E
 E -- "Choice: Go over and invite<br>($friendship +5)" --> F
 E -- "Choice: Ignore them<br>($friendship -5)" --> F
 F -- "Choice: Study together<br>($friendship +2)" --> I
 F -- "Choice: Focus on your own review<br>($friendship -1)" --> I
 I --> I_Choice
 I_Choice -- "Choice: Confront<br>($displaySeverity +0)" --> J
 I_Choice -- "Choice: Pretend you didn't see and walk away<br>($displaySeverity +0.5)" --> J
 I_Choice -- "Choice: Join the gossip<br>($displaySeverity +1)" --> J
 J -- "Choice: Invite them<br>($friendship +2)" --> M
 J -- "Choice: Don't meddle<br>($friendship -1)" --> M
 M --> N
 N -- "Choice: Agree<br>($friendship +10)" --> O
 N -- "Choice: Decline, choose the film club<br>($friendship -5)" --> O
 O --> O_Choice
 O_Choice -- "Choice: Intervene<br>($displaySeverity +0)" --> P
 O_Choice -- "Choice: Pretend you didn't see<br>($displaySeverity +2)" --> P
 O_Choice -- "Choice: Join the mocking<br>($displaySeverity +2.5)" --> P
 P -- "Choice: Invite them<br>($friendship +2)" --> S
 P -- "Choice: Don't meddle<br>($friendship -2)" --> S
 S --> T
 T -- "Choice: Find it together<br>($friendship +2)" --> U
 T -- "Choice: Ask someone else on your own<br>($friendship -1)" --> U
 U --> U_Choice
 U_Choice -- "Choice: Intervene<br>($displaySeverity +0)" --> V
 U_Choice -- "Choice: Flee out of fear<br>($displaySeverity +4)" --> V
 U_Choice -- "Choice: Join the bullying and stick gum in their hair<br>($displaySeverity +6)" --> V
 V -- "Choice: Invite your classmate<br>($friendship +12)" --> Y
 V -- "Choice: Invite a more 'capable' classmate<br>($friendship -8)" --> Y
 Y --> Z
 Z -- "Choice: Sit together<br>($friendship +2)" --> AA
 Z -- "Choice: Sit with other friends<br>($friendship -1)" --> AA
 AA -- "Choice: Ask to team up<br>($friendship +15)" --> BB
 AA -- "Choice: Work alone or with a more talented student<br>($friendship -6)" --> BB
 BB -- "Choice: Pick out outfits together<br>($friendship +2)" --> CC
 BB -- "Choice: Focus only on your own preparations<br>($friendship -1)" --> CC
 
 CC --> E1
 CC --> E2
 CC --> E3
 CC --> E4
 CC --> E5
 CC --> E6
 CC --> E7
 
 E1 --> F1
 E2 --> F1
 E3 --> F1
 E4 --> F1
 E5 --> F1
 E6 --> F1
 E7 --> F1
 
 F1 -- "Play Again" --> A